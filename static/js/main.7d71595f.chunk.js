(this["webpackJsonpcoin-mosaic"]=this["webpackJsonpcoin-mosaic"]||[]).push([[0],{115:function(e,t,a){e.exports=a.p+"static/media/slow.b813673f.gif"},117:function(e,t,a){e.exports=a(309)},122:function(e,t,a){},123:function(e,t,a){},25:function(e,t,a){},309:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(17),o=a.n(l),c=(a(122),a(2)),i=a(5),s=a(4),u=a(3),d=(a(123),a(65)),m=a.n(d),h=a(110),p=a(116),g=a(7),f=(a(25),function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.onSliderChange,n=t.lowVal,l=t.highVal,o=t.min,c=t.max;return r.a.createElement("div",{className:"wrap",role:"group"},r.a.createElement("input",{id:"highVal",className:"high",type:"range",min:o,max:c,value:l,onChange:function(t){return a(Object(g.a)(Object(g.a)({},e.props),{},{e:t}))}}),r.a.createElement("input",{id:"lowVal",className:"low",type:"range",min:o,max:c,value:n,onChange:function(t){return a(Object(g.a)(Object(g.a)({},e.props),{},{e:t}))}}))}}],[{key:"increasing",value:function(e,t){var a=t,n=a.index,r=a.max,l=a.value,o=a.totalSliders,c=a.id,i=a.minGap,s=l+i,u=n+1,d="lowVal"===c?"highVal":"lowVal",m=r-(o-u)*i+("lowVal"===c?-parseInt(i):0);if(m>=r)return e;t=Object(g.a)(Object(g.a)({},t),{},{value:s,index:u});var h=l;if(u>=o)return l>=m&&(h=m),e[n][c]=e[n-1][d]=h,e;if(e[n][c]=h,"lowVal"===c?e[n-1][d]=h:e[u][d]=h,l>=m)h=m,e[n][c]=h,"lowVal"===c?e[n-1][d]=h:e[u][d]=h,e=this.increasing(e,t);else{if(l<e[u][c]-i)return e;t[c]!==parseInt(r)&&(e=this.increasing(e,t))}return e}},{key:"decreasing",value:function(e,t){var a=t,n=a.index,r=a.min,l=a.value,o=a.id,c=a.minGap,i=l-c,s=n-1,u="lowVal"===o?"highVal":"lowVal",d=r+n*c+("highVal"===o?parseInt(c):0);if(d<=r)return e;t=Object(g.a)(Object(g.a)({},t),{},{value:i,index:s});var m=l;return n<=0?(l<=d&&(m=d),e[n][o]=e[n+1][u]=m,e):(n>0&&m>d?(e[n][o]=m,"lowVal"===o?e[s][u]=m:e[n+1][u]=m,l<=e[s][o]+c&&(e=this.decreasing(e,t))):l<=d?(m=d,e[n][o]=m,"lowVal"===o?e[s][u]=m:e[n+1][u]=m,n>0&&(e=this.decreasing(e,t))):e[n][o]=l,e)}}]),a}(n.Component)),v=a(24),b=a(111),y=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).dismissModal=function(){e.props.toggle()},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.colour,n=t.onColourChange,l={backgroundColor:"".concat(a)};return r.a.createElement("div",{className:"modal fade WelcomeModal ".concat(this.props.showModal?"show":""),style:{display:"".concat(this.props.showModal?"block":"none")},id:"WelcomeModal",tabIndex:"-1",role:"dialog","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-lg modal-dialog-centered",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalLongTitle"},"Select Colour"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.dismissModal},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body align-center modal-opened",style:l,align:"center"},r.a.createElement(b.ChromePicker,{color:a,disableAlpha:!0,onChange:function(t){return n(Object(g.a)(Object(g.a)({},e.props),{},{selectedColour:t}))}})))))}}]),a}(n.Component),E=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={showModal:!1},e.toggleModal=function(){return e.setState({showModal:!e.state.showModal})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.diameter,a=e.colour,n=e.defaultValue,l=e.onColourChange,o=Object(v.a)(e,["diameter","colour","defaultValue","onColourChange"]),c={color:"white",borderRadius:"50%",cursor:"pointer",width:"".concat(t,"px"),height:"".concat(t,"px"),lineHeight:"".concat(t,"px"),textAlign:"center",fontSize:"16pt",boxShadow:"-5px 5px 5px 5px #c9c9c9"};return r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"noselect",style:Object(g.a)(Object(g.a)({},c),{},{backgroundColor:a}),onClick:this.toggleModal},n),r.a.createElement(y,Object.assign({toggle:this.toggleModal,showModal:this.state.showModal,colour:a,onColourChange:l},o)))}}]),a}(n.Component),w=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.sliders,a=e.limits,n=e.onColourChange,l=e.onSliderChange,o=t.filter((function(e){return e.enabled}));return r.a.createElement("div",{className:"container m-2"},r.a.createElement("div",{className:"row justify-content-between"},r.a.createElement("div",{className:"col-2 d-flex justify-content-center"},r.a.createElement("p",null,"MIN")),r.a.createElement("div",{className:"col-2 d-flex justify-content-center"},r.a.createElement("p",null,"MAX"))),o.map((function(e){return r.a.createElement("div",{className:"slider-row",key:e.id},r.a.createElement("div",{key:"colour1"+e.id,className:"col-2",align:"center"},r.a.createElement(E,{colour:e.colour,slider:e,diameter:"40",defaultValue:e.lowVal,id:"slider",onColourChange:n})),r.a.createElement("div",{key:"slider"+e.id,className:" col-8 "},r.a.createElement(f,{min:a.min,max:a.max,slider:e,lowVal:e.lowVal,highVal:e.highVal,onSliderChange:l})),r.a.createElement("div",{key:"colour2"+e.id,className:"col-2 ",align:"center"},r.a.createElement(E,{colour:e.colour,slider:e,diameter:"40",defaultValue:e.highVal,id:"slider",onColourChange:n})))})))}}]),a}(n.Component),C=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onClick,a=e.onChange;return r.a.createElement("div",{className:"container  "},r.a.createElement("div",{className:"row p-4"},r.a.createElement("div",{id:"drop",className:"input-group"},r.a.createElement("input",{type:"file",className:"form-control ",placeholder:"Upload Image",onChange:a}),r.a.createElement("span",{className:"input-group-btn input-group-append"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:t},"Process")))))}}]),a}(n.Component),j=a(32),O=a(112),N=a(22),x=a.n(N),k=function e(t){var a=t.name,n=t.label,l=t.error,o=t.type,c=void 0===o?"tel":o,i=Object(v.a)(t,["name","label","error","type"]);return e.defaultProps={type:"tel"},r.a.createElement("div",{className:"form-group m-2"},r.a.createElement("p",{className:"justify-content-center d-flex m-2",htmlFor:a},n),r.a.createElement("input",Object.assign({className:"form-control text-center"},i,{name:a,id:a,type:c})),l&&r.a.createElement("div",{className:"alert alert-danger"},l))},V=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).state={data:{},errors:{}},e.validate=function(){var t=x.a.validate(e.state.data,e.schema,{abortEarly:!1}).error;if(!t)return null;var a,n={},r=Object(O.a)(t.details);try{for(r.s();!(a=r.n()).done;){var l=a.value;n[l.path[0]]=l.message}}catch(o){r.e(o)}finally{r.f()}return console.log(n),n},e.validateProperty=function(t){var a=t.name,n=t.value,r=Object(j.a)({},a,n),l=Object(j.a)({},a,e.schema[a]),o=x.a.validate(r,l).error;return o?o.details[0].message:null},e.handleChange=function(t){var a=t.currentTarget,n=Object(g.a)({},e.state.errors),r=Object(g.a)({},e.state.data),l=e.validateProperty(a);l?n[a.name]=l:(delete n[a.name],r[a.name]=a.value),e.setState({data:r,errors:n})},e.renderButton=function(t){return r.a.createElement("button",{disabled:e.validate(),className:"btn btn-primary"},t)},e.renderInput=function(t){var a=e.state.errors,n=t.name,l=Object(v.a)(t,["name"]);return r.a.createElement(k,Object.assign({name:n,onChange:e.handleChange,error:a[n]},l))},e}return a}(n.Component),S=(a(44),function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={limits:{min:0,max:255},sliders:[{id:0,lowVal:0,highVal:50,enabled:!0,colour:"#2B0D01"},{id:1,lowVal:50,highVal:100,enabled:!0,colour:"#612B09"},{id:2,lowVal:100,highVal:200,enabled:!0,colour:"#8C3D0E"},{id:3,lowVal:200,highVal:255,enabled:!0,colour:"#C2580C"}],minGap:10,data:{width:1600,time:30,coinSize:20.3},errors:{},backgroundColour:"#000000"},e.schema={width:x.a.number().min(100).max(3e3).required().label("Width in mm"),time:x.a.number().min(5).max(300).required().label("Time in seconds"),coinSize:x.a.number().precision(1).min(15).max(30).required().label("Coin diameter in mm")},e.handleSliderChange=function(t){var a=e.state,n=a.minGap,r=a.sliders,l=parseInt(t.e.target.value),o=t.e.target,c=o.id,i=o.min,s=o.max;(t=Object(g.a)(Object(g.a)({},t),{},{index:r.indexOf(t.slider),value:l,totalSliders:r.length,id:c,minGap:n}))[c]!==parseInt(i)&&t[c]!==parseInt(s)&&(r=l>t[c]?f.increasing(r,t):f.decreasing(r,t),e.setState({sliders:r}))},e.handleColourChange=function(t){if("slider"===t.id){var a=Object(p.a)(e.state.sliders),n=a.indexOf(t.slider);a[n].colour=t.selectedColour.hex,e.setState({sliders:a})}else e.setState({backgroundColour:t.selectedColour.hex})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.limits,n=t.sliders,l=t.minGap,o=t.backgroundColour,c=t.data,i=this.props,s=i.onClick,u=i.onChange;return r.a.createElement("form",{autoComplete:"off",className:"my-container-clipped p-2"},r.a.createElement("div",{className:"row "},r.a.createElement(C,{onChange:u,onClick:function(){return s(Object(g.a)({},e.state))}})),r.a.createElement("div",{className:"row "},r.a.createElement(w,{limits:a,sliders:n,minGap:l,onSliderChange:this.handleSliderChange,onColourChange:this.handleColourChange})),r.a.createElement("div",{className:"row p-2 mt-2"},r.a.createElement("div",{className:"col-xs-12 col-md-4 p-2 "},this.renderInput({name:"width",label:"Desired width in mm",defaultValue:c.width})),r.a.createElement("div",{className:"col-xs-12 col-md-4 p-2"},this.renderInput({name:"time",label:"Seconds per coin",defaultValue:c.time})),r.a.createElement("div",{className:"col-xs-12 col-md-4 p-2"},this.renderInput({name:"coinSize",label:"Coin diameter in mm",defaultValue:c.coinSize}))),r.a.createElement("div",{className:"row align-items-center m-2"},r.a.createElement("div",{className:"col-6 text-center"},r.a.createElement("h4",null,"Select background colour:")),r.a.createElement("div",{className:"col-6 text-center"},r.a.createElement(E,{colour:o,diameter:"80",defaultValue:"",id:"bg",onColourChange:this.handleColourChange}))))}}]),a}(V)),R=a(47),M=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=a.srcFormatter(this.props.file);return r.a.createElement("div",null,r.a.createElement(R.a,{src:e,alt:"This has not gone well",fluid:!0}))}}],[{key:"validURL",value:function(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)}},{key:"srcFormatter",value:function(e){return a.validURL(e)?e:URL.createObjectURL(e)}}]),a}(n.Component),D=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"buildSVG",value:function(){var e=this.props,t=e.innerResponseData,a=e.outerResponseData;return r.a.createElement("svg",{viewBox:"0 0 ".concat(1*a.width," ").concat(1*a.height),id:"coinMosaicSVG"},r.a.createElement("rect",{x:"0",y:"0",width:1*a.width,height:1*a.height,fill:a.bgColour}),r.a.createElement("g",null,a.coinArray.map((function(e,t){return r.a.createElement("g",{key:"outer".concat(t)},e.map((function(e,a){return r.a.createElement("circle",{key:"outer".concat(t).concat(a),cx:1*a+.5,cy:1*t+.5,r:"0.5",fill:e})})))}))),r.a.createElement("g",null,t.coinArray.map((function(e,t){return r.a.createElement("g",{key:"inner".concat(t)},e.map((function(e,a){return r.a.createElement("circle",{key:"inner".concat(t).concat(a),cx:1*a+1,cy:1*t+1,r:"0.5",fill:e})})))}))))}},{key:"downloadDimensions",value:function(){var e=this.props.outerResponseData,t=e.height/e.width,a={width:0,height:0};return a.width=2e3,a.height=Math.round(a.width*t),a}},{key:"handleOnClick",value:function(){var e=document.createElement("canvas",{id:"c"}),t=document.getElementById("coinMosaicSVG").cloneNode(!0),a=new XMLSerializer,n=this.downloadDimensions(),r=n.width,l=n.height,o="CoinMosaic".concat(r,"x").concat(l,".png");t.setAttribute("width",r),t.setAttribute("height",l),t.setAttribute("name",o),e.width=r,e.height=l;var c=a.serializeToString(t),i=window.URL||window.webkitURL||window,s=new Image,u=new Blob([c],{type:"image/svg+xml"}),d=i.createObjectURL(u);s.onload=function(){e.getContext("2d").drawImage(s,0,0),i.revokeObjectURL(d);var t=e.toDataURL("image/png"),a=document.createElement("a");document.body.appendChild(a),a.style="display: none",a.href=t,a.download=o,a.click(),window.URL.revokeObjectURL(t),document.body.removeChild(a)},s.src=d}},{key:"render",value:function(){var e=this,t=Date.now(),a=this.buildSVG(),n=Date.now();return console.log(n-t),r.a.createElement("div",{className:"align-items-center"},a,r.a.createElement("button",{onClick:function(t){return e.handleOnClick(t)},className:"btn btn-primary m-2"},"Download Image"),r.a.createElement("div",{id:"d"}),r.a.createElement("br",null))}}]),a}(n.Component),I=a(19),A=a(113),U=a.n(A),L=a(114),z=a(115),T=a.n(z),G=(a(307),function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=this.props.data,t=e.totalCoins,a=e.totalTime,n=e.totalMass;return r.a.createElement("div",{className:"container"},r.a.createElement("h1",null,"The Headline Stats"),r.a.createElement("table",{className:"table "},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",{className:"text-center"},"Total Coins:"),r.a.createElement("td",{className:"text-center"},t)),r.a.createElement("tr",null,r.a.createElement("td",{className:"text-center"},"Time Taken:"),r.a.createElement("td",{className:"text-center"},a)),r.a.createElement("tr",null,r.a.createElement("td",{className:"text-center"},"Mass of Mosaic:"),r.a.createElement("td",{className:"text-center"},n," kg")))))}}]),a}(n.Component)),P=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={file:"https://picsum.photos/1000/700?grayscale",displayCanvas:!1,displayUpload:!1,outerResponseData:{width:null,height:null,coinArray:null,bgColour:null,sliders:null,stats:null},innerResponseData:{width:"",height:"",coinArray:[]},fetchInProgress:!1},e}return Object(i.a)(a,[{key:"handleFile",value:function(e){var t=e.target.files[0];"undefined"===typeof t?this.setState({file:"https://picsum.photos/1000/700?grayscale"}):"image/jpeg"!==t.type&&"image/png"!==t.type?(e.target.value=null,this.setState({file:"https://picsum.photos/1000/700?grayscale"}),I.b.error("File needs to be a jpeg or png")):this.setState({file:t,displayUpload:!0,displayCanvas:!1})}},{key:"handleUpload",value:function(){var e=Object(h.a)(m.a.mark((function e(t){var a,n,r=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.state.file,!M.validURL(a)){e.next=4;break}return I.b.error("Need to select an image"),e.abrupt("return");case 4:if(Object(L.isEmpty)(t.errors)){e.next=7;break}return I.b.error("Correct the error of your ways to proceed"),e.abrupt("return");case 7:return(n=new FormData).append("image",a),n.append("userInput",JSON.stringify(t)),this.setState({fetchInProgress:!1}),e.next=13,U()({url:"http://127.0.0.1:5000/api/imagetransfer",method:"POST",headers:{"Content-Type":"multipart/form-data"},data:n,contentType:!1,processData:!1}).then((function(e){r.handleReturn(e.data)})).catch((function(e){r.handleError(e)}));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleError",value:function(e){e.response?I.b.error("".concat(e.response," occured whilst processing the image")):e.request?I.b.error("".concat(e.request," occured whilst processing the image")):I.b.error("".concat(e," occured whilst processing the image"))}},{key:"handleReturn",value:function(e){console.log("RETURNED");var t=this.state,a=t.innerResponseData,n=t.outerResponseData,r=e.outer;if(n={width:r.width,height:r.height,coinArray:r.coin_array,bgColour:r.bg_colour,stats:r.stats},console.log(e),"None"!==e.inner){var l=e.inner;a={width:l.width,height:l.height,coinArray:l.coin_array}}this.setState({displayCanvas:!0,innerResponseData:a,outerResponseData:n,fetchInProgress:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.displayCanvas,n=t.displayUpload,l=t.innerResponseData,o=t.outerResponseData,c={},i={};return t.fetchInProgress?i={display:"none"}:c={display:"none"},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:c},r.a.createElement("div",{className:"container"},r.a.createElement(R.a,{src:T.a,alt:"Loading...",fluid:!0}))),r.a.createElement("div",{style:i},r.a.createElement(I.a,null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center mb-4"},a?r.a.createElement(G,{data:o.stats}):null),r.a.createElement("div",{className:"row justify-content-center mb-4"},r.a.createElement("div",{className:"col-xs-12 col-md-6"},n?r.a.createElement(M,{file:this.state.file}):null),r.a.createElement("div",{className:"col-xs-12 col-md-6"},a?r.a.createElement(D,{innerResponseData:l,outerResponseData:o}):null)),r.a.createElement("div",{className:"mb-4"},r.a.createElement(S,{onChange:function(t){return e.handleFile(t)},onClick:function(t){return e.handleUpload(t)}})))))}}]),a}(n.Component),F=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"jumbotron jumbotron-fluid noselect"},r.a.createElement("div",{className:"container text-center"},r.a.createElement("h1",{className:"display-4 "},"Coin Mosaic"),r.a.createElement("p",{className:"lead"},"Convert your pictures into excessively large coin mosaics in one easy click.")))}}]),a}(n.Component),B=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement("main",{className:"App"},r.a.createElement(P,null)))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(308);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},44:function(e,t,a){}},[[117,1,2]]]);
//# sourceMappingURL=main.7d71595f.chunk.js.map